var jFNA=jQuery.sheet.advancedfn={FACTORIAL:function(a){fact=1;for(i=a;i>0;i--){fact*=i;}return fact;},COMBINATION:function(b,a){return jFNA.FACTORIAL(b)/jFNA.FACTORIAL(a)/jFNA.FACTORIAL(b-a);},PERMUTATION:function(b,a){return jFNA.FACTORIAL(b)/jFNA.FACTORIAL(b-a);},GAMMA:function(a){if(a>0){if(a!=Math.floor(a)){var c=1;while(a<8){c*=a;a++;}var b=1/(a*a);return exp(((((((((-3617/122400)*b+7/1092)*b-691/360360)*b+5/5940)*b-1/1680)*b+1/1260)*b-1/360)*b+1/12)/a+0.5*Math.log(2*Math.PI)-Math.log(c)-a+(a-0.5)*Math.log(a));}else{return jFNA.FACTORIAL(a-1);}}return false;},PRECISION:function(a,b){var c=Math.pow(10,Math.floor(Math.log(1/b)*Math.LOG10E));return Math.round(c*a)/c;},MINIMUM:function(){var a=jFNA.external.sanitize(arguments);var b=a[0];for(i=0;i<a.length;i++){if(a[i]<b){b=a[i];}}return b;},MODE:function(){var c=jFNA.external.sanitize(arguments);var e=c.sort(function(j,h){return j-h;});var f=1;var b=0;var g=[];var d=[];for(i=0;i<e.length;i++){if(e[i]==e[i+1]){f++;}else{g[b]=f;d[b]=e[i];b++;f=1;}}var a=g[0];b=0;for(i=0;i<g.length;i++){if(g[i]>a){a=g[i];b=i;}}return d[b];},MEDIAN:function(){var a=jFNA.external.sanitize(arguments);var b=a.sort(function(d,c){return d-c;});return b[Math.round((a.length)/2)-1];},QUARTILES:function(){var a=jFNA.external.sanitize(arguments);var b=a.sort(function c(e,d){return e-d;});return[b[Math.round((b.length)/4)-1],b[Math.round((b.length)/2)-1],b[Math.round((b.length)*3/4)-1]];},VARIANCE:function(){var a=jFNA.external.sanitize(arguments);var c=[];var b=jFNA.external.mean(a);for(i=0;i<a.length;i++){c[i]=Math.pow(a[i]-b,2);}return jFNA.external.sum(c)/a.length;},MEANDEV:function(){var a=jFNA.external.sanitize(arguments);var b=[];var c=jFNA.external.sum(a);for(i=0;i<a.length;i++){b[i]=Math.abs(a[i]-c);}return jFNA.external.sum(b)/a.length;},STDEV:function(){var a=jFNA.external.sanitize(arguments),b=jFNA.external.sum(a)/a.length,c=[];for(key in a){c[key]=Math.pow(a[key]-b,2);}return Math.sqrt(jFNA.external.sum(c)/(c.length-1));},COVARIANCE:function(d,b){var c=jFNA.external.mean(d);var a=jFNA.external.mean(b);var e=[];for(i=0;i<d.length;i++){e[i]=(d[i]-c)*(b[i]-a);}return jFNA.external.sum(e)/d.length;},CORR_COEFF:function(b,a){return jFNA.COVARIANCE(b,a)/jFNA.STDEV(b)/jFNA.STDEV(a);},UNIFORMCDF:function(e,d,c){if(c<e){return 0;}else{if(c<d){return(c-e)/(d-e);}}return 1;},BINOMIAL:function(c,b,a){return jFNA.COMBINATION(c,a)*Math.pow(b,a)*Math.pow(1-b,c-a);},BINOMIALCDF:function(e,d,a){if(a<0){return 0;}var c=[];for(k=0;k<e;k++){c[k]=jFNA.BINOMIAL(e,d,k);}if(a<e){var b=0;for(i=0;i<=a;i++){b+=c[i];}return b;}return 1;},NEGBIN:function(b,c,a){if(a!=Math.floor(a)){return false;}if(a<0){return 0;}else{return jFNA.COMBINATION(a+b-1,b-1)*Math.pow(c,b)*Math.pow(1-c,a);}},NEGBINCDF:function(d,c,a){if(a<0){return 0;}var b=0;for(k=0;k<=a;k++){b+=jFNA.NEGBIN(d,c,k);}return b;},HYPGEOM:function(c,b,d,a){if(a!=Math.floor(a)){return false;}if(a<0){return 0;}else{return jFNA.COMBINATION(b,a)*jFNA.COMBINATION((c-b),d-a)/jFNA.COMBINATION(c,d);}},HYPGEOMCDF:function(d,b,e,a){if(a<0){return 0;}var c=0;for(k=0;k<=a;k++){c+=jFNA.HYPGEOM(d,b,e,k);}return c;},EXPONENTIALCDF:function(b,a){return 1-Math.exp(-b*a);},POISSON:function(b,a){return Math.pow(b,a)*Math.exp(-b)/jFNA.FACTORIAL(a);},POISSONCDF:function(b,a){if(a<0){return 0;}var c=0;for(k=0;k<=a;k++){c+=jFNA.POISSON(b,k);}return c;},NORMCDF:function(a,c,b){return jFNA.ASR(Function("x","return Math.exp(-Math.pow(x-"+a+",2)/Math.pow("+c+",2)/2)/"+c+"/Math.sqrt(2*Math.PI)"),0,b,1e-14);},LINEAR_REQ_EQ:function(f,h){var c=jFNA.external.mean(f);var a=jFNA.external.mean(h);var g=[];var e=[];for(i=0;i<f.length;i++){g[i]=(f[i]-c)*(h[i]-a);e[i]=Math.pow(h[i]-a,2);}var d=jFNA.external.sum(g)/jFNA.external.sum(e);var b=c-d*a;return Function("x","return "+d+"*x+"+b);},EXP_REG_EQ:function(e,h){for(i=0;i<e.length;i++){(e[i]=Math.log(e[i]));}var c=jFNA.external.mean(e);var b=jFNA.external.mean(h);var f=[];var d=[];for(i=0;i<e.length;i++){f[i]=(e[i]-c)*(h[i]-b);d[i]=Math.pow(h[i]-b,2);}var a=jFNA.external.sum(f)/jFNA.external.sum(d);var g=Math.exp(c-a*b);return Function("x","return Math.exp("+a+"*x)*"+g);},SECANTMETHOD:function(e,c,a,b,h){var g;for(n=1;n<=h;n++){var f=e(a);g=(a-c)/(f-e(c))*f;if(Math.abs(g)<b){return a;}c=a;a=a-g;}return a;},FIVEPT:function(c,a,b){return(-c(a+b*2)+8*c(a+b)-8*c(a-b)+c(a-b*2))/b/12;},FCRIT:function(e,d,c){return jFNA.PRECISION(jFNA.SECANTMETHOD(Function("t","return jQuery.sheet.advancedfn.FIVEPT("+e+",t,1e-3)"),d,c,1e-13,99999),1e-12);},ASR:function(m,q,p,r){var o=(q+p)/2;var l=(p-q)/6;var g=m(q);var e=m(p);var d=m(o);var j=function(y,E,C,B,H,z,w,v,t){var G=(E+B)/2;var A=(B+C)/2;var x=(B-E)/6;var D=y(A);var s=y(G);var u=(w+4*s+t)*x;var F=(t+4*D+v)*x;if(Math.abs(u+F-z)<=15*H){return u+F+(u+F-z)/15;}return j(y,E,B,G,H/2,u,w,t,s)+j(y,B,C,A,H/2,F,t,v,D);};return jFNA.PRECISION(j(m,q,p,o,r,l*(g+e+4*d),g,e,d),r);}};jFNA.external=jQuery.sheet.advancedfn.external={sum:function(a){a=this.sanitize(a);var b=0;for(i=0;i<a.length;i++){b+=a[i];}return b;},mean:function(a){a=this.sanitize(a);return jFNA.external.sum(a)/a.length;},sanitize:function(){return arrHelpers.toNumbers(arguments);}};