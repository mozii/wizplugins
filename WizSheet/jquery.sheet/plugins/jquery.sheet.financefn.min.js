var jSF=jQuery.sheet.financefn={NPV:function(d){d=d*1;var b=1;var c=0;for(var a=1;a<arguments.length;a++){var b=b*(1+d);c+=arguments[a]/b;}return{value:c,html:Globalize.format(c,"c")};},PV:function(d,a,c,f,b){f=f||0;b=b||0;var e;if(d!=0){e=(-c*(1+d*b)*((Math.pow(1+d,a)-1)/d)-f)/Math.pow(1+d,a);}else{e=-f-c*a;}return{value:e,html:Globalize.format(e,"c")};},RATE:function(h,d,q,c,l,m){c=c||0;l=l||0;m=m||0.1;var k=m,n=0,g=0,r=128,j=1e-8;if(Math.abs(k)<j){n=q*(1+h*k)+d*(1+k*l)*h+c;}else{g=Math.exp(h*Math.log(1+k));n=q*g+d*(1/k+l)*(g-1)+c;}var p=q+d*h+c,o=q*g+d*(1/k+l)*(g-1)+c;var e=0,b=0,a=k;while((Math.abs(p-o)>j)&&(e<r)){k=(o*b-p*a)/(o-p);b=a;a=k;if(Math.abs(k)<j){n=q*(1+h*k)+d*(1+k*l)*h+c;}else{g=Math.exp(h*Math.log(1+k));n=q*g+d*(1/k+l)*(g-1)+c;}p=o;o=n;++e;}return{value:k,html:Globalize.format(k,"p")};},IPMT:function(f,c,b,g,h,e){var d=jFN.PMT(f,b,g,h,e).value,h=jFN.FV(f,c-1,d,g,e).value,a=h*f;if(e){a/=(1+f);}return{value:a,html:Globalize.format(a,"c")};},PMT:function(d,a,e,f,c){f=f||0;c=c||0;var b=d/(Math.pow(1+d,a)-1)*-(e*Math.pow(1+d,a)+f);if(c==1){b=b/(1+d);}return{value:b,html:Globalize.format(b,"c")};},NPER:function(d,c,e,f,b){var a=Math.log;d=parseFloat(d||0);c=parseFloat(c||0);e=parseFloat(e||0);f=f||0;b=b||0;if(d==0){return(-(e+f)/c);}else{if(b>0){return(a(-(d*f-c*(1+d))/(d*e+c*(1+d)))/a(1+d));}else{return(a(-(d*(f-c))/(d*(e+c)))/a(1+d));}}},FV:function(e,b,d,f,c){f=(f?f:0);c=(c?c:0);var a=-(f*Math.pow(1+e,b)+d*(1+e*c)*(Math.pow(1+e,b)-1)/e);return{value:a,html:Globalize.format(a,"c")};}};